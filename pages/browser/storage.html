<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端存储技术 | 不断进步</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/vue-press-docs/不断进步.JPG">
    <meta name="description" content="Hit的前端笔记">
    
    <link rel="preload" href="/vue-press-docs/assets/css/0.styles.8e0a4dbf.css" as="style"><link rel="preload" href="/vue-press-docs/assets/js/app.d8725ef0.js" as="script"><link rel="preload" href="/vue-press-docs/assets/js/2.a05206b7.js" as="script"><link rel="preload" href="/vue-press-docs/assets/js/4.0911b1c1.js" as="script"><link rel="prefetch" href="/vue-press-docs/assets/js/10.291c5b1d.js"><link rel="prefetch" href="/vue-press-docs/assets/js/11.837906d7.js"><link rel="prefetch" href="/vue-press-docs/assets/js/12.68839ecd.js"><link rel="prefetch" href="/vue-press-docs/assets/js/13.c5264567.js"><link rel="prefetch" href="/vue-press-docs/assets/js/14.29739af6.js"><link rel="prefetch" href="/vue-press-docs/assets/js/15.e3c8b020.js"><link rel="prefetch" href="/vue-press-docs/assets/js/16.218006ef.js"><link rel="prefetch" href="/vue-press-docs/assets/js/17.e118f6a2.js"><link rel="prefetch" href="/vue-press-docs/assets/js/18.a6aa10bb.js"><link rel="prefetch" href="/vue-press-docs/assets/js/19.8a65c4ea.js"><link rel="prefetch" href="/vue-press-docs/assets/js/20.2a59e164.js"><link rel="prefetch" href="/vue-press-docs/assets/js/21.f3d67e95.js"><link rel="prefetch" href="/vue-press-docs/assets/js/22.0f5ad16d.js"><link rel="prefetch" href="/vue-press-docs/assets/js/23.21d9d0f1.js"><link rel="prefetch" href="/vue-press-docs/assets/js/24.3d484fb5.js"><link rel="prefetch" href="/vue-press-docs/assets/js/25.c603a96a.js"><link rel="prefetch" href="/vue-press-docs/assets/js/26.9ab9b754.js"><link rel="prefetch" href="/vue-press-docs/assets/js/27.38a22fef.js"><link rel="prefetch" href="/vue-press-docs/assets/js/28.a6fb0ad4.js"><link rel="prefetch" href="/vue-press-docs/assets/js/29.6b6978f8.js"><link rel="prefetch" href="/vue-press-docs/assets/js/3.a38e7322.js"><link rel="prefetch" href="/vue-press-docs/assets/js/30.9105745c.js"><link rel="prefetch" href="/vue-press-docs/assets/js/31.646dcbc3.js"><link rel="prefetch" href="/vue-press-docs/assets/js/32.6fb88f54.js"><link rel="prefetch" href="/vue-press-docs/assets/js/33.efb42491.js"><link rel="prefetch" href="/vue-press-docs/assets/js/34.53339129.js"><link rel="prefetch" href="/vue-press-docs/assets/js/35.368c2a62.js"><link rel="prefetch" href="/vue-press-docs/assets/js/36.593a1558.js"><link rel="prefetch" href="/vue-press-docs/assets/js/37.03b7eb3f.js"><link rel="prefetch" href="/vue-press-docs/assets/js/38.119c7171.js"><link rel="prefetch" href="/vue-press-docs/assets/js/39.f3303696.js"><link rel="prefetch" href="/vue-press-docs/assets/js/40.a727a31c.js"><link rel="prefetch" href="/vue-press-docs/assets/js/41.df01778a.js"><link rel="prefetch" href="/vue-press-docs/assets/js/42.24907559.js"><link rel="prefetch" href="/vue-press-docs/assets/js/43.f7efdd24.js"><link rel="prefetch" href="/vue-press-docs/assets/js/44.ed8a586a.js"><link rel="prefetch" href="/vue-press-docs/assets/js/45.4153c8f6.js"><link rel="prefetch" href="/vue-press-docs/assets/js/46.38ee2887.js"><link rel="prefetch" href="/vue-press-docs/assets/js/47.fafe4e22.js"><link rel="prefetch" href="/vue-press-docs/assets/js/48.11cf3a32.js"><link rel="prefetch" href="/vue-press-docs/assets/js/49.9b4b506b.js"><link rel="prefetch" href="/vue-press-docs/assets/js/5.30bb248a.js"><link rel="prefetch" href="/vue-press-docs/assets/js/50.90535ee5.js"><link rel="prefetch" href="/vue-press-docs/assets/js/51.59a46172.js"><link rel="prefetch" href="/vue-press-docs/assets/js/52.34a795d5.js"><link rel="prefetch" href="/vue-press-docs/assets/js/53.b82f43b1.js"><link rel="prefetch" href="/vue-press-docs/assets/js/54.9a76148f.js"><link rel="prefetch" href="/vue-press-docs/assets/js/55.75ac5779.js"><link rel="prefetch" href="/vue-press-docs/assets/js/56.afdafb93.js"><link rel="prefetch" href="/vue-press-docs/assets/js/57.769f07f9.js"><link rel="prefetch" href="/vue-press-docs/assets/js/58.91bd0e5b.js"><link rel="prefetch" href="/vue-press-docs/assets/js/59.9b1b7a2b.js"><link rel="prefetch" href="/vue-press-docs/assets/js/6.262368dc.js"><link rel="prefetch" href="/vue-press-docs/assets/js/60.79f7ba50.js"><link rel="prefetch" href="/vue-press-docs/assets/js/61.e2b3466d.js"><link rel="prefetch" href="/vue-press-docs/assets/js/62.25ae7055.js"><link rel="prefetch" href="/vue-press-docs/assets/js/63.1c398391.js"><link rel="prefetch" href="/vue-press-docs/assets/js/64.8fa35e00.js"><link rel="prefetch" href="/vue-press-docs/assets/js/65.6c8bf068.js"><link rel="prefetch" href="/vue-press-docs/assets/js/66.44daef8f.js"><link rel="prefetch" href="/vue-press-docs/assets/js/67.66f09b37.js"><link rel="prefetch" href="/vue-press-docs/assets/js/68.6ffa134a.js"><link rel="prefetch" href="/vue-press-docs/assets/js/69.d547c1ee.js"><link rel="prefetch" href="/vue-press-docs/assets/js/7.fd046e46.js"><link rel="prefetch" href="/vue-press-docs/assets/js/70.c933e292.js"><link rel="prefetch" href="/vue-press-docs/assets/js/71.4170c744.js"><link rel="prefetch" href="/vue-press-docs/assets/js/72.759f4574.js"><link rel="prefetch" href="/vue-press-docs/assets/js/73.60ef846f.js"><link rel="prefetch" href="/vue-press-docs/assets/js/74.bcd5ecfd.js"><link rel="prefetch" href="/vue-press-docs/assets/js/75.20843078.js"><link rel="prefetch" href="/vue-press-docs/assets/js/76.fc952e66.js"><link rel="prefetch" href="/vue-press-docs/assets/js/77.7dd7f97f.js"><link rel="prefetch" href="/vue-press-docs/assets/js/78.2650c24b.js"><link rel="prefetch" href="/vue-press-docs/assets/js/79.b8caa6ba.js"><link rel="prefetch" href="/vue-press-docs/assets/js/8.a8d31d14.js"><link rel="prefetch" href="/vue-press-docs/assets/js/80.4a4a3d20.js"><link rel="prefetch" href="/vue-press-docs/assets/js/81.86cec7de.js"><link rel="prefetch" href="/vue-press-docs/assets/js/9.179dc13a.js">
    <link rel="stylesheet" href="/vue-press-docs/assets/css/0.styles.8e0a4dbf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vue-press-docs/" class="home-link router-link-active"><img src="/vue-press-docs/hit.JPG" alt="不断进步" class="logo"> <span class="site-name can-hide">不断进步</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vue-press-docs/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/html/html.html" class="nav-link">
  html系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/css/css.html" class="nav-link">
  css系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/javaScript/Object.freeze()和const.html" class="nav-link">
  javaScript系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/typeScript/base.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/http/http.html" class="nav-link">
  http系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/project/guide.html" class="nav-link">
  前端工程化系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/node/node.html" class="nav-link">
  node系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/browser/browser.html" class="nav-link">
  浏览器系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/framework/nextTick.html" class="nav-link">
  框架使用系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/framework-source/vue-source.html" class="nav-link">
  框架源码系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/optimization/vue-code.html" class="nav-link">
  性能优化系列
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Huhui-coder" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vue-press-docs/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/html/html.html" class="nav-link">
  html系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/css/css.html" class="nav-link">
  css系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/javaScript/Object.freeze()和const.html" class="nav-link">
  javaScript系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/typeScript/base.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/http/http.html" class="nav-link">
  http系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/project/guide.html" class="nav-link">
  前端工程化系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/node/node.html" class="nav-link">
  node系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/browser/browser.html" class="nav-link">
  浏览器系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/framework/nextTick.html" class="nav-link">
  框架使用系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/framework-source/vue-source.html" class="nav-link">
  框架源码系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/optimization/vue-code.html" class="nav-link">
  性能优化系列
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Huhui-coder" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>浏览器</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue-press-docs/pages/browser/browser.html" class="sidebar-link">前端攻击技术</a></li><li><a href="/vue-press-docs/pages/browser/storage.html" aria-current="page" class="active sidebar-link">前端存储技术</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/browser/storage.html#http-文件缓存" class="sidebar-link">HTTP 文件缓存</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/browser/storage.html#协商缓存" class="sidebar-link">协商缓存</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/browser/storage.html#强缓存" class="sidebar-link">强缓存</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/browser/storage.html#localstorage" class="sidebar-link">localStorage</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/browser/storage.html#如何监听-localstorage-存储内容改变" class="sidebar-link">如何监听 localStorage 存储内容改变</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/browser/storage.html#sessionstorage" class="sidebar-link">sessionStorage</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/browser/storage.html#cookie" class="sidebar-link">Cookie</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/browser/storage.html#前端如何获取-cookie-何种情况下前端获取不到-cookie" class="sidebar-link">前端如何获取 cookie, 何种情况下前端获取不到 cookie?</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/browser/storage.html#跨域会不会携带-cookie-如果能-如何设置" class="sidebar-link">跨域会不会携带 cookie, 如果能，如何设置？</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/browser/storage.html#websql" class="sidebar-link">webSQL</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/browser/storage.html#indexdb" class="sidebar-link">IndexDB</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/browser/storage.html#application-cache" class="sidebar-link">Application Cache</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/browser/storage.html#cachestorage" class="sidebar-link">cacheStorage</a></li></ul></li><li><a href="/vue-press-docs/pages/browser/auth.html" class="sidebar-link">前端认证技术</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="前端存储技术"><a href="#前端存储技术" class="header-anchor">#</a> 前端存储技术</h1> <h2 id="http-文件缓存"><a href="#http-文件缓存" class="header-anchor">#</a> HTTP 文件缓存</h2> <p>在文件重复请求的情况下，浏览器可以根据 HTTP 响应的协议头信息判断是从服务器端请求文件还是从本地读取文件。</p> <h3 id="协商缓存"><a href="#协商缓存" class="header-anchor">#</a> 协商缓存</h3> <h3 id="强缓存"><a href="#强缓存" class="header-anchor">#</a> 强缓存</h3> <h2 id="localstorage"><a href="#localstorage" class="header-anchor">#</a> localStorage</h2> <p>localStorage 是一种 html5 的本地缓存方案。
它的核心方法只有：</p> <ul><li>localStorage.setItem(key, value)</li> <li>localStorage.getItem(key)</li> <li>localStorage.removeItem(key)</li> <li>localStorage.clear()</li></ul> <p>由于 localStorage 只支持简单数据类型的读取，为了方便读取对象等格式的内容，通常还需要封装一层再进行使用。</p> <div class="demo-block demo-en-US demo-storage.html" data-v-47d1da0a><div class="demo-content" data-v-47d1da0a><div>
  封装localStorage
</div></div> <div class="meta" data-v-47d1da0a><!----> <div class="code-content" data-v-47d1da0a><div class="language-html line-numbers-mode" data-v-47d1da0a><pre class="language-html" data-v-47d1da0a><code data-v-47d1da0a><span class="token tag" data-v-47d1da0a><span class="token tag" data-v-47d1da0a><span class="token punctuation" data-v-47d1da0a>&lt;</span>template</span><span class="token punctuation" data-v-47d1da0a>&gt;</span></span>
  封装localStorage
<span class="token tag" data-v-47d1da0a><span class="token tag" data-v-47d1da0a><span class="token punctuation" data-v-47d1da0a>&lt;/</span>template</span><span class="token punctuation" data-v-47d1da0a>&gt;</span></span>
<span class="token tag" data-v-47d1da0a><span class="token tag" data-v-47d1da0a><span class="token punctuation" data-v-47d1da0a>&lt;</span>script</span><span class="token punctuation" data-v-47d1da0a>&gt;</span></span><span class="token script" data-v-47d1da0a><span class="token language-javascript" data-v-47d1da0a>
  <span class="token keyword" data-v-47d1da0a>let</span> rkey <span class="token operator" data-v-47d1da0a>=</span> <span class="token regex" data-v-47d1da0a><span class="token regex-delimiter" data-v-47d1da0a>/</span><span class="token regex-source language-regex" data-v-47d1da0a>^[0-9A-Za-z_@-]*$</span><span class="token regex-delimiter" data-v-47d1da0a>/</span></span><span class="token punctuation" data-v-47d1da0a>;</span>
  <span class="token keyword" data-v-47d1da0a>let</span> store<span class="token punctuation" data-v-47d1da0a>;</span>

  <span class="token comment" data-v-47d1da0a>// 转换对象</span>
  <span class="token keyword" data-v-47d1da0a>function</span> <span class="token function" data-v-47d1da0a>init</span><span class="token punctuation" data-v-47d1da0a>(</span><span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
    <span class="token keyword" data-v-47d1da0a>if</span> <span class="token punctuation" data-v-47d1da0a>(</span><span class="token keyword" data-v-47d1da0a>typeof</span> store <span class="token operator" data-v-47d1da0a>===</span> <span class="token string" data-v-47d1da0a>&quot;undefined&quot;</span><span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
      store <span class="token operator" data-v-47d1da0a>=</span> window<span class="token punctuation" data-v-47d1da0a>[</span><span class="token string" data-v-47d1da0a>&quot;localStorage&quot;</span><span class="token punctuation" data-v-47d1da0a>]</span><span class="token punctuation" data-v-47d1da0a>;</span>
    <span class="token punctuation" data-v-47d1da0a>}</span>
    <span class="token keyword" data-v-47d1da0a>return</span> <span class="token boolean" data-v-47d1da0a>true</span><span class="token punctuation" data-v-47d1da0a>;</span>
  <span class="token punctuation" data-v-47d1da0a>}</span>

  <span class="token comment" data-v-47d1da0a>// 判断localStorage 的key值是否合法</span>
  <span class="token keyword" data-v-47d1da0a>function</span> <span class="token function" data-v-47d1da0a>isVaildKey</span><span class="token punctuation" data-v-47d1da0a>(</span><span class="token parameter" data-v-47d1da0a>key</span><span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
    <span class="token keyword" data-v-47d1da0a>if</span> <span class="token punctuation" data-v-47d1da0a>(</span><span class="token keyword" data-v-47d1da0a>typeof</span> key <span class="token operator" data-v-47d1da0a>!==</span> <span class="token string" data-v-47d1da0a>&quot;string&quot;</span><span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
      <span class="token keyword" data-v-47d1da0a>return</span> <span class="token boolean" data-v-47d1da0a>false</span><span class="token punctuation" data-v-47d1da0a>;</span>
    <span class="token punctuation" data-v-47d1da0a>}</span>
    <span class="token keyword" data-v-47d1da0a>return</span> rkey<span class="token punctuation" data-v-47d1da0a>.</span><span class="token function" data-v-47d1da0a>test</span><span class="token punctuation" data-v-47d1da0a>(</span>key<span class="token punctuation" data-v-47d1da0a>)</span><span class="token punctuation" data-v-47d1da0a>;</span>
  <span class="token punctuation" data-v-47d1da0a>}</span>
  <span class="token keyword" data-v-47d1da0a>let</span> exports <span class="token operator" data-v-47d1da0a>=</span> <span class="token punctuation" data-v-47d1da0a>{</span>
    <span class="token function" data-v-47d1da0a>set</span><span class="token punctuation" data-v-47d1da0a>(</span>key<span class="token punctuation" data-v-47d1da0a>,</span> value<span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
      <span class="token keyword" data-v-47d1da0a>let</span> success <span class="token operator" data-v-47d1da0a>=</span> <span class="token boolean" data-v-47d1da0a>false</span><span class="token punctuation" data-v-47d1da0a>;</span>
      <span class="token keyword" data-v-47d1da0a>if</span> <span class="token punctuation" data-v-47d1da0a>(</span><span class="token function" data-v-47d1da0a>isVaildKey</span><span class="token punctuation" data-v-47d1da0a>(</span>key<span class="token punctuation" data-v-47d1da0a>)</span> <span class="token operator" data-v-47d1da0a>&amp;&amp;</span> <span class="token function" data-v-47d1da0a>init</span><span class="token punctuation" data-v-47d1da0a>(</span><span class="token punctuation" data-v-47d1da0a>)</span><span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
        <span class="token keyword" data-v-47d1da0a>try</span> <span class="token punctuation" data-v-47d1da0a>{</span>
          value <span class="token operator" data-v-47d1da0a>+=</span> <span class="token string" data-v-47d1da0a>&quot;&quot;</span><span class="token punctuation" data-v-47d1da0a>;</span>
          store<span class="token punctuation" data-v-47d1da0a>.</span><span class="token function" data-v-47d1da0a>setItem</span><span class="token punctuation" data-v-47d1da0a>(</span>key<span class="token punctuation" data-v-47d1da0a>,</span> value<span class="token punctuation" data-v-47d1da0a>)</span><span class="token punctuation" data-v-47d1da0a>;</span>
          success <span class="token operator" data-v-47d1da0a>=</span> <span class="token boolean" data-v-47d1da0a>true</span><span class="token punctuation" data-v-47d1da0a>;</span>
        <span class="token punctuation" data-v-47d1da0a>}</span> <span class="token keyword" data-v-47d1da0a>catch</span> <span class="token punctuation" data-v-47d1da0a>(</span>e<span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
          console<span class="token punctuation" data-v-47d1da0a>.</span><span class="token function" data-v-47d1da0a>error</span><span class="token punctuation" data-v-47d1da0a>(</span>e<span class="token punctuation" data-v-47d1da0a>)</span><span class="token punctuation" data-v-47d1da0a>;</span>
        <span class="token punctuation" data-v-47d1da0a>}</span>
      <span class="token punctuation" data-v-47d1da0a>}</span>
    <span class="token punctuation" data-v-47d1da0a>}</span><span class="token punctuation" data-v-47d1da0a>,</span>
    <span class="token function" data-v-47d1da0a>get</span><span class="token punctuation" data-v-47d1da0a>(</span>key<span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
      <span class="token keyword" data-v-47d1da0a>if</span> <span class="token punctuation" data-v-47d1da0a>(</span><span class="token function" data-v-47d1da0a>isVaildKey</span><span class="token punctuation" data-v-47d1da0a>(</span>key<span class="token punctuation" data-v-47d1da0a>)</span> <span class="token operator" data-v-47d1da0a>&amp;&amp;</span> <span class="token function" data-v-47d1da0a>init</span><span class="token punctuation" data-v-47d1da0a>(</span><span class="token punctuation" data-v-47d1da0a>)</span><span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
        <span class="token keyword" data-v-47d1da0a>try</span> <span class="token punctuation" data-v-47d1da0a>{</span>
          <span class="token keyword" data-v-47d1da0a>return</span> store<span class="token punctuation" data-v-47d1da0a>.</span><span class="token function" data-v-47d1da0a>getItem</span><span class="token punctuation" data-v-47d1da0a>(</span>key<span class="token punctuation" data-v-47d1da0a>)</span><span class="token punctuation" data-v-47d1da0a>;</span>
        <span class="token punctuation" data-v-47d1da0a>}</span> <span class="token keyword" data-v-47d1da0a>catch</span> <span class="token punctuation" data-v-47d1da0a>(</span>e<span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
          console<span class="token punctuation" data-v-47d1da0a>.</span><span class="token function" data-v-47d1da0a>error</span><span class="token punctuation" data-v-47d1da0a>(</span>e<span class="token punctuation" data-v-47d1da0a>)</span><span class="token punctuation" data-v-47d1da0a>;</span>
        <span class="token punctuation" data-v-47d1da0a>}</span>
      <span class="token punctuation" data-v-47d1da0a>}</span>
      <span class="token keyword" data-v-47d1da0a>return</span> <span class="token keyword" data-v-47d1da0a>null</span><span class="token punctuation" data-v-47d1da0a>;</span>
    <span class="token punctuation" data-v-47d1da0a>}</span><span class="token punctuation" data-v-47d1da0a>,</span>
    <span class="token function" data-v-47d1da0a>remove</span><span class="token punctuation" data-v-47d1da0a>(</span><span class="token parameter" data-v-47d1da0a>key</span><span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
      <span class="token keyword" data-v-47d1da0a>if</span> <span class="token punctuation" data-v-47d1da0a>(</span><span class="token function" data-v-47d1da0a>isVaildKey</span><span class="token punctuation" data-v-47d1da0a>(</span>key<span class="token punctuation" data-v-47d1da0a>)</span> <span class="token operator" data-v-47d1da0a>&amp;&amp;</span> <span class="token function" data-v-47d1da0a>init</span><span class="token punctuation" data-v-47d1da0a>(</span><span class="token punctuation" data-v-47d1da0a>)</span><span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
        <span class="token keyword" data-v-47d1da0a>try</span> <span class="token punctuation" data-v-47d1da0a>{</span>
          store<span class="token punctuation" data-v-47d1da0a>.</span><span class="token function" data-v-47d1da0a>removeItem</span><span class="token punctuation" data-v-47d1da0a>(</span>key<span class="token punctuation" data-v-47d1da0a>)</span><span class="token punctuation" data-v-47d1da0a>;</span>
          <span class="token keyword" data-v-47d1da0a>return</span> <span class="token boolean" data-v-47d1da0a>true</span><span class="token punctuation" data-v-47d1da0a>;</span>
        <span class="token punctuation" data-v-47d1da0a>}</span> <span class="token keyword" data-v-47d1da0a>catch</span> <span class="token punctuation" data-v-47d1da0a>(</span>e<span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
          console<span class="token punctuation" data-v-47d1da0a>.</span><span class="token function" data-v-47d1da0a>error</span><span class="token punctuation" data-v-47d1da0a>(</span>e<span class="token punctuation" data-v-47d1da0a>)</span><span class="token punctuation" data-v-47d1da0a>;</span>
        <span class="token punctuation" data-v-47d1da0a>}</span>
      <span class="token punctuation" data-v-47d1da0a>}</span>
      <span class="token keyword" data-v-47d1da0a>return</span> <span class="token boolean" data-v-47d1da0a>false</span><span class="token punctuation" data-v-47d1da0a>;</span>
    <span class="token punctuation" data-v-47d1da0a>}</span><span class="token punctuation" data-v-47d1da0a>,</span>
    <span class="token function" data-v-47d1da0a>clear</span><span class="token punctuation" data-v-47d1da0a>(</span><span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
      <span class="token keyword" data-v-47d1da0a>if</span> <span class="token punctuation" data-v-47d1da0a>(</span><span class="token function" data-v-47d1da0a>init</span><span class="token punctuation" data-v-47d1da0a>(</span><span class="token punctuation" data-v-47d1da0a>)</span><span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
        <span class="token keyword" data-v-47d1da0a>try</span> <span class="token punctuation" data-v-47d1da0a>{</span>
          <span class="token keyword" data-v-47d1da0a>for</span> <span class="token punctuation" data-v-47d1da0a>(</span><span class="token keyword" data-v-47d1da0a>let</span> key <span class="token keyword" data-v-47d1da0a>in</span> store<span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
            store<span class="token punctuation" data-v-47d1da0a>.</span><span class="token function" data-v-47d1da0a>removeItem</span><span class="token punctuation" data-v-47d1da0a>(</span>key<span class="token punctuation" data-v-47d1da0a>)</span><span class="token punctuation" data-v-47d1da0a>;</span>
          <span class="token punctuation" data-v-47d1da0a>}</span>
          <span class="token keyword" data-v-47d1da0a>return</span> <span class="token boolean" data-v-47d1da0a>true</span><span class="token punctuation" data-v-47d1da0a>;</span>
        <span class="token punctuation" data-v-47d1da0a>}</span> <span class="token keyword" data-v-47d1da0a>catch</span> <span class="token punctuation" data-v-47d1da0a>(</span>e<span class="token punctuation" data-v-47d1da0a>)</span> <span class="token punctuation" data-v-47d1da0a>{</span>
          console<span class="token punctuation" data-v-47d1da0a>.</span><span class="token function" data-v-47d1da0a>error</span><span class="token punctuation" data-v-47d1da0a>(</span>e<span class="token punctuation" data-v-47d1da0a>)</span><span class="token punctuation" data-v-47d1da0a>;</span>
        <span class="token punctuation" data-v-47d1da0a>}</span>
        <span class="token keyword" data-v-47d1da0a>return</span> <span class="token boolean" data-v-47d1da0a>false</span><span class="token punctuation" data-v-47d1da0a>;</span>
      <span class="token punctuation" data-v-47d1da0a>}</span>
    <span class="token punctuation" data-v-47d1da0a>}</span><span class="token punctuation" data-v-47d1da0a>,</span>
  <span class="token punctuation" data-v-47d1da0a>}</span><span class="token punctuation" data-v-47d1da0a>;</span>
  <span class="token keyword" data-v-47d1da0a>export</span> <span class="token keyword" data-v-47d1da0a>default</span> <span class="token punctuation" data-v-47d1da0a>{</span><span class="token punctuation" data-v-47d1da0a>}</span><span class="token punctuation" data-v-47d1da0a>;</span>
</span></span><span class="token tag" data-v-47d1da0a><span class="token tag" data-v-47d1da0a><span class="token punctuation" data-v-47d1da0a>&lt;/</span>script</span><span class="token punctuation" data-v-47d1da0a>&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper" data-v-47d1da0a><span class="line-number" data-v-47d1da0a>1</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>2</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>3</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>4</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>5</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>6</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>7</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>8</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>9</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>10</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>11</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>12</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>13</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>14</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>15</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>16</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>17</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>18</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>19</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>20</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>21</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>22</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>23</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>24</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>25</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>26</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>27</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>28</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>29</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>30</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>31</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>32</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>33</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>34</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>35</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>36</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>37</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>38</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>39</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>40</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>41</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>42</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>43</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>44</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>45</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>46</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>47</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>48</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>49</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>50</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>51</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>52</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>53</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>54</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>55</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>56</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>57</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>58</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>59</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>60</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>61</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>62</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>63</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>64</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>65</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>66</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>67</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>68</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>69</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>70</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>71</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>72</span><br data-v-47d1da0a></div></div></div></div> <div class="demo-block-control" style="width:unset;" data-v-47d1da0a><i class="caret-bottom icon" data-v-47d1da0a data-v-47d1da0a></i> <span style="display:none;" data-v-47d1da0a data-v-47d1da0a>Expand</span> <span class="copy-action" style="display:;" data-v-47d1da0a>Copy</span> <span class="copy-action copy-action-success" style="display:none;" data-v-47d1da0a data-v-47d1da0a>Copy</span></div></div><blockquote><p>尽管单个域名下的 localStorage 是有限制的，但是我们可以用 iframe 的方式使用多个域名来突破单个页面下的存储限制(5MB)，另外使用浏览器多个标签页打开同个域名页面时，localStorage 内容一般是共享的(不能跨域)。</p></blockquote> <p><a href="https://www.cnblogs.com/cherishSmile/p/8390754.html" target="_blank" rel="noopener noreferrer">使用 iframe 来突破单个页面存储限制<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="如何监听-localstorage-存储内容改变"><a href="#如何监听-localstorage-存储内容改变" class="header-anchor">#</a> 如何监听 localStorage 存储内容改变</h3> <p>在单个页面下，是无法监听到页面存储内容改变的，想要监听到内容改变有如下几个条件：</p> <ul><li>同一浏览器打开了两个同源页面</li> <li>其中一个网页修改了 localStorage</li> <li>另一网页注册了 storage 事件</li></ul> <div class="demo-block demo-en-US demo-storage.html" data-v-47d1da0a><div class="demo-content" data-v-47d1da0a><div>
  监听到页面localStorage存储内容改变
</div></div> <div class="meta" data-v-47d1da0a><!----> <div class="code-content" data-v-47d1da0a><div class="language-html line-numbers-mode" data-v-47d1da0a><pre class="language-html" data-v-47d1da0a><code data-v-47d1da0a><span class="token tag" data-v-47d1da0a><span class="token tag" data-v-47d1da0a><span class="token punctuation" data-v-47d1da0a>&lt;</span>template</span><span class="token punctuation" data-v-47d1da0a>&gt;</span></span>
  监听到页面localStorage存储内容改变
<span class="token tag" data-v-47d1da0a><span class="token tag" data-v-47d1da0a><span class="token punctuation" data-v-47d1da0a>&lt;/</span>template</span><span class="token punctuation" data-v-47d1da0a>&gt;</span></span>
<span class="token tag" data-v-47d1da0a><span class="token tag" data-v-47d1da0a><span class="token punctuation" data-v-47d1da0a>&lt;</span>script</span><span class="token punctuation" data-v-47d1da0a>&gt;</span></span><span class="token script" data-v-47d1da0a><span class="token language-javascript" data-v-47d1da0a>
  <span class="token comment" data-v-47d1da0a>// 一个网页修改 localStorage a.html</span>
  <span class="token comment" data-v-47d1da0a>//   window.onload = () =&gt; {</span>
  <span class="token comment" data-v-47d1da0a>//     var changeStorage = function(value) {</span>
  <span class="token comment" data-v-47d1da0a>//       window.localStorage.setItem(&quot;name&quot;, value);</span>
  <span class="token comment" data-v-47d1da0a>//       let stroe = window.localStorage.getItem(&quot;name&quot;);</span>
  <span class="token comment" data-v-47d1da0a>//       document.getElementById(&quot;app&quot;).innerHTML = stroe;</span>
  <span class="token comment" data-v-47d1da0a>//     };</span>
  <span class="token comment" data-v-47d1da0a>//     changeStorage(&quot;hhh22&quot;);</span>
  <span class="token comment" data-v-47d1da0a>//     setTimeout(() =&gt; {</span>
  <span class="token comment" data-v-47d1da0a>//       changeStorage(&quot;hhh33&quot;);</span>
  <span class="token comment" data-v-47d1da0a>//     }, 3000);</span>
  <span class="token comment" data-v-47d1da0a>//   };</span>

  <span class="token comment" data-v-47d1da0a>// 另一个同源的页面注册 storage 事件 ， b.html</span>
  <span class="token comment" data-v-47d1da0a>//   (() =&gt; {</span>
  <span class="token comment" data-v-47d1da0a>//     window.addEventListener(&quot;storage&quot;, (e) =&gt; {</span>
  <span class="token comment" data-v-47d1da0a>//       console.log(&quot;key&quot;, e.key); // key name</span>
  <span class="token comment" data-v-47d1da0a>//       console.log(&quot;oldValue&quot;, e.oldValue); // oldValue hhh33</span>
  <span class="token comment" data-v-47d1da0a>//       console.log(&quot;newValue&quot;, e.newValue); // newValue hhh22</span>
  <span class="token comment" data-v-47d1da0a>//     });</span>
  <span class="token comment" data-v-47d1da0a>//   })(window);</span>

  <span class="token keyword" data-v-47d1da0a>export</span> <span class="token keyword" data-v-47d1da0a>default</span> <span class="token punctuation" data-v-47d1da0a>{</span><span class="token punctuation" data-v-47d1da0a>}</span><span class="token punctuation" data-v-47d1da0a>;</span>
</span></span><span class="token tag" data-v-47d1da0a><span class="token tag" data-v-47d1da0a><span class="token punctuation" data-v-47d1da0a>&lt;/</span>script</span><span class="token punctuation" data-v-47d1da0a>&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper" data-v-47d1da0a><span class="line-number" data-v-47d1da0a>1</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>2</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>3</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>4</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>5</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>6</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>7</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>8</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>9</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>10</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>11</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>12</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>13</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>14</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>15</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>16</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>17</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>18</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>19</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>20</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>21</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>22</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>23</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>24</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>25</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>26</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>27</span><br data-v-47d1da0a><span class="line-number" data-v-47d1da0a>28</span><br data-v-47d1da0a></div></div></div></div> <div class="demo-block-control" style="width:unset;" data-v-47d1da0a><i class="caret-bottom icon" data-v-47d1da0a data-v-47d1da0a></i> <span style="display:none;" data-v-47d1da0a data-v-47d1da0a>Expand</span> <span class="copy-action" style="display:;" data-v-47d1da0a>Copy</span> <span class="copy-action copy-action-success" style="display:none;" data-v-47d1da0a data-v-47d1da0a>Copy</span></div></div><h2 id="sessionstorage"><a href="#sessionstorage" class="header-anchor">#</a> sessionStorage</h2> <p>与 localStorage 基本类似，并且使用的 API 完全相同，有一点不一样。</p> <p>那就是 <strong>sessionStorage 在浏览器关闭时会自动清空，无法进行客户端的持久化数据存储</strong></p> <h2 id="cookie"><a href="#cookie" class="header-anchor">#</a> Cookie</h2> <p>一般用来辨别用户身份信息，Cookie 信息一般会通过 HTTP 请求发送到服务器端。一条 Cookie 记录主要由键、值、域、过期时间和大小组成。不同的浏览器对于所支持 Cookie 存储的大小和条数都有着不同的限制。</p> <p>Chrome 浏览器，对于存储的 Cookie 条数是没有限制的，大小限制在 4kb 左右。</p> <p>和 localStorge 类似，不同域名之间的 Cookie 也是互相独立的，不过 Cookie 是可以设置 父域 与 子域 之间的 Cookie 信息共享。</p> <p><a href="https://zhuanlan.zhihu.com/p/35738376?group_id=969283251281616896" target="_blank" rel="noopener noreferrer">使用 localstorage 代替 cookie 实现跨域共享数据<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="前端如何获取-cookie-何种情况下前端获取不到-cookie"><a href="#前端如何获取-cookie-何种情况下前端获取不到-cookie" class="header-anchor">#</a> 前端如何获取 cookie, 何种情况下前端获取不到 cookie?</h3> <p>前端使用 <code>document.cookie</code> 来获取, 得到的是一串包含<code>key=value;key1=value1</code> 的字符串，所以前端在获取到 cookie 之后不是很方便进行处理，一般都会借助工具库来处理，比如<code>js-cookie</code>。</p> <p>当服务器端设置了 <code>httpOnly: true</code>时，客户端将获取不到 Cookie.
服务器端设置 cookie 示例。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// express</span>
<span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> cookieParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;cookie-parser&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用 cookieParser 中间件;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cookieParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 如果请求中的 cookie 存在 isFirst</span>
<span class="token comment">// 否则，设置 cookie 字段 isFirst, 并设置过期时间为10秒</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>isFirst<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;再次欢迎访问&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">cookie</span><span class="token punctuation">(</span><span class="token string">&quot;isFirst&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> maxAge<span class="token operator">:</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span> httpOnly<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;欢迎第一次访问&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3030</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;express start on: &quot;</span> <span class="token operator">+</span> <span class="token number">3030</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="跨域会不会携带-cookie-如果能-如何设置"><a href="#跨域会不会携带-cookie-如果能-如何设置" class="header-anchor">#</a> 跨域会不会携带 cookie, 如果能，如何设置？</h3> <p>默认情况下，使用<code>axios</code>作为ajax请求库的话，同域是默认会带上cookie的，然而，跨域就不会默认带上cookie。
想要跨域带上cookie就必须得手动设置一下。</p> <p>前端：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>后端：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;源地址&quot;</span><span class="token punctuation">;</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Credentials&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="websql"><a href="#websql" class="header-anchor">#</a> webSQL</h2> <h2 id="indexdb"><a href="#indexdb" class="header-anchor">#</a> IndexDB</h2> <h2 id="application-cache"><a href="#application-cache" class="header-anchor">#</a> Application Cache</h2> <h2 id="cachestorage"><a href="#cachestorage" class="header-anchor">#</a> cacheStorage</h2></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">lastUpdate:</span> <span class="time">11/14/2020, 9:43:04 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vue-press-docs/pages/browser/browser.html" class="prev">
        前端攻击技术
      </a></span> <span class="next"><a href="/vue-press-docs/pages/browser/auth.html">
        前端认证技术
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vue-press-docs/assets/js/app.d8725ef0.js" defer></script><script src="/vue-press-docs/assets/js/2.a05206b7.js" defer></script><script src="/vue-press-docs/assets/js/4.0911b1c1.js" defer></script>
  </body>
</html>
