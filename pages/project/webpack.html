<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack 在项目中的作用 | 不断进步</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/vue-press-docs/不断进步.JPG">
    <meta name="description" content="Hit的前端笔记">
    
    <link rel="preload" href="/vue-press-docs/assets/css/0.styles.8e0a4dbf.css" as="style"><link rel="preload" href="/vue-press-docs/assets/js/app.d8725ef0.js" as="script"><link rel="preload" href="/vue-press-docs/assets/js/2.a05206b7.js" as="script"><link rel="preload" href="/vue-press-docs/assets/js/72.759f4574.js" as="script"><link rel="prefetch" href="/vue-press-docs/assets/js/10.291c5b1d.js"><link rel="prefetch" href="/vue-press-docs/assets/js/11.837906d7.js"><link rel="prefetch" href="/vue-press-docs/assets/js/12.68839ecd.js"><link rel="prefetch" href="/vue-press-docs/assets/js/13.c5264567.js"><link rel="prefetch" href="/vue-press-docs/assets/js/14.29739af6.js"><link rel="prefetch" href="/vue-press-docs/assets/js/15.e3c8b020.js"><link rel="prefetch" href="/vue-press-docs/assets/js/16.218006ef.js"><link rel="prefetch" href="/vue-press-docs/assets/js/17.e118f6a2.js"><link rel="prefetch" href="/vue-press-docs/assets/js/18.a6aa10bb.js"><link rel="prefetch" href="/vue-press-docs/assets/js/19.8a65c4ea.js"><link rel="prefetch" href="/vue-press-docs/assets/js/20.2a59e164.js"><link rel="prefetch" href="/vue-press-docs/assets/js/21.f3d67e95.js"><link rel="prefetch" href="/vue-press-docs/assets/js/22.0f5ad16d.js"><link rel="prefetch" href="/vue-press-docs/assets/js/23.21d9d0f1.js"><link rel="prefetch" href="/vue-press-docs/assets/js/24.3d484fb5.js"><link rel="prefetch" href="/vue-press-docs/assets/js/25.c603a96a.js"><link rel="prefetch" href="/vue-press-docs/assets/js/26.9ab9b754.js"><link rel="prefetch" href="/vue-press-docs/assets/js/27.38a22fef.js"><link rel="prefetch" href="/vue-press-docs/assets/js/28.a6fb0ad4.js"><link rel="prefetch" href="/vue-press-docs/assets/js/29.6b6978f8.js"><link rel="prefetch" href="/vue-press-docs/assets/js/3.a38e7322.js"><link rel="prefetch" href="/vue-press-docs/assets/js/30.9105745c.js"><link rel="prefetch" href="/vue-press-docs/assets/js/31.646dcbc3.js"><link rel="prefetch" href="/vue-press-docs/assets/js/32.6fb88f54.js"><link rel="prefetch" href="/vue-press-docs/assets/js/33.efb42491.js"><link rel="prefetch" href="/vue-press-docs/assets/js/34.53339129.js"><link rel="prefetch" href="/vue-press-docs/assets/js/35.368c2a62.js"><link rel="prefetch" href="/vue-press-docs/assets/js/36.593a1558.js"><link rel="prefetch" href="/vue-press-docs/assets/js/37.03b7eb3f.js"><link rel="prefetch" href="/vue-press-docs/assets/js/38.119c7171.js"><link rel="prefetch" href="/vue-press-docs/assets/js/39.f3303696.js"><link rel="prefetch" href="/vue-press-docs/assets/js/4.0911b1c1.js"><link rel="prefetch" href="/vue-press-docs/assets/js/40.a727a31c.js"><link rel="prefetch" href="/vue-press-docs/assets/js/41.df01778a.js"><link rel="prefetch" href="/vue-press-docs/assets/js/42.24907559.js"><link rel="prefetch" href="/vue-press-docs/assets/js/43.f7efdd24.js"><link rel="prefetch" href="/vue-press-docs/assets/js/44.ed8a586a.js"><link rel="prefetch" href="/vue-press-docs/assets/js/45.4153c8f6.js"><link rel="prefetch" href="/vue-press-docs/assets/js/46.38ee2887.js"><link rel="prefetch" href="/vue-press-docs/assets/js/47.fafe4e22.js"><link rel="prefetch" href="/vue-press-docs/assets/js/48.11cf3a32.js"><link rel="prefetch" href="/vue-press-docs/assets/js/49.9b4b506b.js"><link rel="prefetch" href="/vue-press-docs/assets/js/5.30bb248a.js"><link rel="prefetch" href="/vue-press-docs/assets/js/50.90535ee5.js"><link rel="prefetch" href="/vue-press-docs/assets/js/51.59a46172.js"><link rel="prefetch" href="/vue-press-docs/assets/js/52.34a795d5.js"><link rel="prefetch" href="/vue-press-docs/assets/js/53.b82f43b1.js"><link rel="prefetch" href="/vue-press-docs/assets/js/54.9a76148f.js"><link rel="prefetch" href="/vue-press-docs/assets/js/55.75ac5779.js"><link rel="prefetch" href="/vue-press-docs/assets/js/56.afdafb93.js"><link rel="prefetch" href="/vue-press-docs/assets/js/57.769f07f9.js"><link rel="prefetch" href="/vue-press-docs/assets/js/58.91bd0e5b.js"><link rel="prefetch" href="/vue-press-docs/assets/js/59.9b1b7a2b.js"><link rel="prefetch" href="/vue-press-docs/assets/js/6.262368dc.js"><link rel="prefetch" href="/vue-press-docs/assets/js/60.79f7ba50.js"><link rel="prefetch" href="/vue-press-docs/assets/js/61.e2b3466d.js"><link rel="prefetch" href="/vue-press-docs/assets/js/62.25ae7055.js"><link rel="prefetch" href="/vue-press-docs/assets/js/63.1c398391.js"><link rel="prefetch" href="/vue-press-docs/assets/js/64.8fa35e00.js"><link rel="prefetch" href="/vue-press-docs/assets/js/65.6c8bf068.js"><link rel="prefetch" href="/vue-press-docs/assets/js/66.44daef8f.js"><link rel="prefetch" href="/vue-press-docs/assets/js/67.66f09b37.js"><link rel="prefetch" href="/vue-press-docs/assets/js/68.6ffa134a.js"><link rel="prefetch" href="/vue-press-docs/assets/js/69.d547c1ee.js"><link rel="prefetch" href="/vue-press-docs/assets/js/7.fd046e46.js"><link rel="prefetch" href="/vue-press-docs/assets/js/70.c933e292.js"><link rel="prefetch" href="/vue-press-docs/assets/js/71.4170c744.js"><link rel="prefetch" href="/vue-press-docs/assets/js/73.60ef846f.js"><link rel="prefetch" href="/vue-press-docs/assets/js/74.bcd5ecfd.js"><link rel="prefetch" href="/vue-press-docs/assets/js/75.20843078.js"><link rel="prefetch" href="/vue-press-docs/assets/js/76.fc952e66.js"><link rel="prefetch" href="/vue-press-docs/assets/js/77.7dd7f97f.js"><link rel="prefetch" href="/vue-press-docs/assets/js/78.2650c24b.js"><link rel="prefetch" href="/vue-press-docs/assets/js/79.b8caa6ba.js"><link rel="prefetch" href="/vue-press-docs/assets/js/8.a8d31d14.js"><link rel="prefetch" href="/vue-press-docs/assets/js/80.4a4a3d20.js"><link rel="prefetch" href="/vue-press-docs/assets/js/81.86cec7de.js"><link rel="prefetch" href="/vue-press-docs/assets/js/9.179dc13a.js">
    <link rel="stylesheet" href="/vue-press-docs/assets/css/0.styles.8e0a4dbf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vue-press-docs/" class="home-link router-link-active"><img src="/vue-press-docs/hit.JPG" alt="不断进步" class="logo"> <span class="site-name can-hide">不断进步</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vue-press-docs/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/html/html.html" class="nav-link">
  html系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/css/css.html" class="nav-link">
  css系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/javaScript/Object.freeze()和const.html" class="nav-link">
  javaScript系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/typeScript/base.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/http/http.html" class="nav-link">
  http系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/project/guide.html" class="nav-link">
  前端工程化系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/node/node.html" class="nav-link">
  node系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/browser/browser.html" class="nav-link">
  浏览器系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/framework/nextTick.html" class="nav-link">
  框架使用系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/framework-source/vue-source.html" class="nav-link">
  框架源码系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/optimization/vue-code.html" class="nav-link">
  性能优化系列
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Huhui-coder" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vue-press-docs/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/html/html.html" class="nav-link">
  html系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/css/css.html" class="nav-link">
  css系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/javaScript/Object.freeze()和const.html" class="nav-link">
  javaScript系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/typeScript/base.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/http/http.html" class="nav-link">
  http系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/project/guide.html" class="nav-link">
  前端工程化系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/node/node.html" class="nav-link">
  node系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/browser/browser.html" class="nav-link">
  浏览器系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/framework/nextTick.html" class="nav-link">
  框架使用系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/framework-source/vue-source.html" class="nav-link">
  框架源码系列
</a></li><li class="dropdown-item"><!----> <a href="/vue-press-docs/pages/optimization/vue-code.html" class="nav-link">
  性能优化系列
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Huhui-coder" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>前端工程化</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue-press-docs/pages/project/strong.html" class="sidebar-link">代码的健壮性</a></li><li><a href="/vue-press-docs/pages/project/clean.html" class="sidebar-link">代码整洁性</a></li><li><a href="/vue-press-docs/pages/project/guide.html" class="sidebar-link">代码规范</a></li><li><a href="/vue-press-docs/pages/project/specification.html" class="sidebar-link">项目配置</a></li><li><a href="/vue-press-docs/pages/project/webpack.html" aria-current="page" class="active sidebar-link">webpack</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#webpack-在项目中的作用" class="sidebar-link">webpack 在项目中的作用</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#webpack-核心概念" class="sidebar-link">webpack 核心概念</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#webpack-基本配置-api" class="sidebar-link">webpack 基本配置 api</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#entry-和-ouput-是配置入口文件和打包输出文件【如何配置多页面应用-】" class="sidebar-link">entry 和 ouput 是配置入口文件和打包输出文件【如何配置多页面应用?】</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#loader" class="sidebar-link">Loader</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#plugins" class="sidebar-link">plugins</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#配置-sourcemap" class="sidebar-link">配置 sourceMap</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#配置-webpack-dev-server" class="sidebar-link">配置 webpack-dev-server</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#常见的-loader-有哪些" class="sidebar-link">常见的 loader 有哪些</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#file-loader" class="sidebar-link">file-loader</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#less-loader" class="sidebar-link">less-loader</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#px2rem-loader" class="sidebar-link">px2rem-loader</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#常见的-plugin-有哪些" class="sidebar-link">常见的 plugin 有哪些？</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#html-webpack-plugin" class="sidebar-link">html-webpack-plugin</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#clean-webpack-plugin" class="sidebar-link">clean-webpack-plugin</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#html-webpack-externals-plugin" class="sidebar-link">html-webpack-externals-plugin</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#常见配置项" class="sidebar-link">常见配置项</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#配置-tree-shaking" class="sidebar-link">配置 tree-shaking</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#node-模块中的-path-join-与-path-resolve-之间的区别" class="sidebar-link">node 模块中的 path.join 与 path.resolve 之间的区别</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#如何配置别名" class="sidebar-link">如何配置别名</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#webpack-dev-server-插件的作用" class="sidebar-link">webpack-dev-server 插件的作用</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#不同环境下使用不同的打包配置" class="sidebar-link">不同环境下使用不同的打包配置</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#对于-webpack-与浏览器缓存如何处理" class="sidebar-link">对于 webpack 与浏览器缓存如何处理</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#配置-hmr-热模块替换" class="sidebar-link">配置 HMR (热模块替换)</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#打包-es6-代码-兼容性处理" class="sidebar-link">打包 ES6 代码，(兼容性处理)</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#如何配置一个多页面入口的应用" class="sidebar-link">如何配置一个多页面入口的应用？</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#在项目中使用-webpack-做根据代码所处环境动态改变项目中的-baseurl" class="sidebar-link">在项目中使用 webpack 做根据代码所处环境动态改变项目中的 baseURL</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#在项目中使用到的-webpack-优化配置项" class="sidebar-link">在项目中使用到的 webpack 优化配置项</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#优化打包速度" class="sidebar-link">优化打包速度</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#优化打包的体积" class="sidebar-link">优化打包的体积</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#优化首屏加载速度" class="sidebar-link">优化首屏加载速度</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#你在项目中是如何做-webpack-优化的" class="sidebar-link">你在项目中是如何做 webpack 优化的?</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#代码分片" class="sidebar-link">代码分片</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#什么是按需加载-资源异步加载" class="sidebar-link">什么是按需加载(资源异步加载)？</a></li><li class="sidebar-sub-header"><a href="/vue-press-docs/pages/project/webpack.html#生产环境下-webpack-的配置" class="sidebar-link">生产环境下 webpack 的配置</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>微前端</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="webpack-在项目中的作用"><a href="#webpack-在项目中的作用" class="header-anchor">#</a> webpack 在项目中的作用</h2> <p>项目构建是什么？包含哪些方面？</p> <ul><li>代码转换：将编译代码中的 js、less、scss</li> <li>文件优化：减少文件的大小，对文件进行压缩。(减少服务器资源占用，从而提高浏览器渲染速度)</li> <li>代码分割：提取首页加载不需要用到的代码，让其进行异步加载</li> <li>模块合并：在采用模块化的项目里会有很多个模块和文件，需要构建功能把模块分类合并成一个文件</li> <li>自动刷新：监听本地源代码的变化，自动重新构建、刷新浏览器</li> <li>代码校验：js 语法的检查</li> <li>自动发布：更新完代码后，自动构建出线上发布代码并传输给发布系统</li></ul> <p>使用 webpack + 代码部署脚本 即可实现 一键完成代码构建和项目上线。</p> <h2 id="webpack-核心概念"><a href="#webpack-核心概念" class="header-anchor">#</a> webpack 核心概念</h2> <ul><li>Entry：配置模块入口</li> <li>Output：配置如何输出最终想要的代码</li> <li>Module：配置处理模块的规则</li> <li>Resolve：配置寻找模块的规则</li> <li>Plugins：配置扩展插件</li> <li>DevServer：配置 DevServer，就是起一个服务</li> <li>其他配置项：其他零散的配置项</li> <li>整体配置结构：整体的描述各配置项的结构</li> <li>多种配置类型：配置文件不不止可以返回一个 Object，还可以返回其他格式</li> <li>配置总结：寻找配置 Webpack 的规则，减少思维负担。</li></ul> <h2 id="webpack-基本配置-api"><a href="#webpack-基本配置-api" class="header-anchor">#</a> webpack 基本配置 api</h2> <h3 id="entry-和-ouput-是配置入口文件和打包输出文件【如何配置多页面应用-】"><a href="#entry-和-ouput-是配置入口文件和打包输出文件【如何配置多页面应用-】" class="header-anchor">#</a> entry 和 ouput 是配置入口文件和打包输出文件【如何配置多页面应用?】</h3> <h3 id="loader"><a href="#loader" class="header-anchor">#</a> Loader</h3> <p>由于 webpack 默认只支持 js 和 json 的格式进行打包，对于像 css,font,less,scss,图片啥的资源是无法直接进行处理的。
需要配置 loader 去支持其他文件类型解析成为 webpack 能够打包的模块，并可加入到依赖图中。
常用的 loader 有
file-loader【用来处理图片】,
url-loader【用来处理图片】,
vue-loader【处理.vue 文件】,
style-loader, css-loader, less-loader,postcss-loader</p> <p>讲一个 webpack 在使用 Loader 进行性能优化的例子。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 其中的limit 字段表示，如果图片的大小小于 所设置的值，那么该图片会转化成为base64打包进js代码中，从而减少http请求数。</span>
module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token punctuation">{</span>
      loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'[name]_[hash].[ext]'</span><span class="token punctuation">,</span>
        outputPath<span class="token operator">:</span> <span class="token string">'images/'</span><span class="token punctuation">,</span>
        limit<span class="token operator">:</span> <span class="token number">10240</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>总结：loader 的作用就是对不同类型的文件进行打包</p> <h3 id="plugins"><a href="#plugins" class="header-anchor">#</a> plugins</h3> <p>作用是为 webpack 提供额外的能力，以增强 webpack,用于对 bundle 文件的优化，资源管理与环境变量的注入。</p> <p>有类似于<code>vue</code>的生命周期，作用于 webpack 构建的整个流程中。</p> <p>常用的 plugins
<code>html-webpack-plugin</code>:这个插件会帮助我们在 webpack 打包结束后，自动生成一个 html 文件，并把打包产生文件引入到这个 html 文件中去。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 给 webpack 添加一项配置 plugins</span>
<span class="token operator">...</span>
plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">htmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    template<span class="token operator">:</span> <span class="token string">'src/index.html'</span><span class="token punctuation">,</span> <span class="token comment">// 模板文件</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token operator">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><code>clean-webpack-plugin</code>: 这个插件能帮我们在打包之前先删除掉打包出来的文件夹。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 引入 clean-webpack-plugin</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span>
plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">htmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    template<span class="token operator">:</span> <span class="token string">'src/index.html'</span><span class="token punctuation">,</span> <span class="token comment">// 模板文件</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">cleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token operator">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="配置-sourcemap"><a href="#配置-sourcemap" class="header-anchor">#</a> 配置 sourceMap</h3> <p>sourceMap 是一个映射关系，能够帮我们更好的定位源码的错误。
<img src="https://webpack-doc-20200329.now.sh/assets/img/sourcemap4.4134342d.png" alt="source配置">
项目开发的最佳实践：
开发环境下</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>devtool<span class="token operator">:</span> <span class="token string">&quot;cheap-module-eval-source-map&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>生产环境下</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>devtool<span class="token operator">:</span> <span class="token string">&quot;cheap-module-source-map&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果不想将 sourceMap 文件打包到最终的包里面，可以设置<code>devtool: 'none'</code>。这样可以极大的减少 bundle 包的体积，但是也看不了源代码了。</p> <h3 id="配置-webpack-dev-server"><a href="#配置-webpack-dev-server" class="header-anchor">#</a> 配置 webpack-dev-server</h3> <p>我们在平时的开发过程当中，一般在我们的项目中肯定去会发一些 ajax 请求，而这个请求是基于 http 协议的，所以我们需要起一个服务器，在我们起的这个服务器中去完成我们的一系列功能开发。</p> <p>这个时候就会用到 webpack-dev-derver，它有很多的参数可供我们配置，比如项目启动的时候自动帮我们开启浏览器、指定端口起服务器等、自动帮我们刷新浏览器</p> <h2 id="常见的-loader-有哪些"><a href="#常见的-loader-有哪些" class="header-anchor">#</a> 常见的 loader 有哪些</h2> <h3 id="file-loader"><a href="#file-loader" class="header-anchor">#</a> file-loader</h3> <p>如何处理 webpack 打包文件中的静态资源
在 module 对象下的 rules 数组中，来配置静态资源的解析规则。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(gif|png|jpe?g|eot|woff|ttf|svg|pdf)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">// 条件匹配，还可以是 include 和 exclude 三个配置来选中 loader 要应用规则的文件</span>
      use<span class="token operator">:</span> <span class="token punctuation">{</span>
        loader<span class="token operator">:</span> <span class="token string">&quot;file-loader&quot;</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">&quot;[name].[ext]&quot;</span><span class="token punctuation">,</span>
          limit<span class="token operator">:</span> <span class="token number">10240</span><span class="token punctuation">,</span>
          outputPath<span class="token operator">:</span> <span class="token string">&quot;images/&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 将图片打包进某个具体的文件夹中</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>file-loader 可以 limit 当 图片大小大于这个值时，将图片打包进 /images 文件夹中，当图片小于这个值时，将图片转化为 base64 的格式打包进 js 中。 这个选项可以对【最终打包的文件大小】和【减少 http 请求】起到一个平衡的作用。</p> <h3 id="less-loader"><a href="#less-loader" class="header-anchor">#</a> less-loader</h3> <p>如何配置 less 模块化
模块化的目的在于， 同一 class 类名 互相不干扰</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                    loader<span class="token operator">:</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
                    options<span class="token operator">:</span> <span class="token punctuation">{</span>
                        importLoaders<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                        modules<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 实现less 模块化</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'less-loader'</span><span class="token punctuation">,</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                exclude<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'node_modules'</span><span class="token punctuation">)</span>

            <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>再将 less 文件的引入方式改一下
原来是 <code>import './index.less'</code>
改为 <code>import style from './index.less'</code></p> <h3 id="px2rem-loader"><a href="#px2rem-loader" class="header-anchor">#</a> px2rem-loader</h3> <p>如何实现 px2rem 在 webpack 中。
webpack 中可以配置 less 的解析规则 使用 px2rem-loader 和 amfe-flexible 来达到这个目的</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                    loader<span class="token operator">:</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
                    options<span class="token operator">:</span> <span class="token punctuation">{</span>
                        importLoaders<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                        modules<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 实现less 模块化</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'less-loader'</span><span class="token punctuation">,</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>
                        loader<span class="token operator">:</span> <span class="token string">'px2rem-loader'</span><span class="token punctuation">,</span>
                        options<span class="token operator">:</span> <span class="token punctuation">{</span>
                            remUnit<span class="token operator">:</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token comment">// rem 相对 px 转换的单位，1rem = 75px</span>
                            remPrecision<span class="token operator">:</span> <span class="token number">8</span> <span class="token comment">// px 转化为 rem 小数点的位数</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                exclude<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'node_modules'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="常见的-plugin-有哪些"><a href="#常见的-plugin-有哪些" class="header-anchor">#</a> 常见的 plugin 有哪些？</h2> <h3 id="html-webpack-plugin"><a href="#html-webpack-plugin" class="header-anchor">#</a> html-webpack-plugin</h3> <p>最常见的是 <code>html-webpack-plugin</code> 这个 plugin 主要作用是将打包后的资源包含(js,css)自动的插入最终的 index.html 中，并且你还能指定一个 index.html 作为 template 模板，可以在 html-webpack-plugin 构造函数的配置对象中设置。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">htmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    template<span class="token operator">:</span> <span class="token string">&quot;./index.html&quot;</span><span class="token punctuation">,</span>
    title<span class="token operator">:</span> <span class="token string">&quot;Hit&quot;</span><span class="token punctuation">,</span>
    inject<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 可选值有 true 或者 body[所有的js资源插入到body元素的底部] head[所有js资源插入到heade元素中] false [所有的css,js 资源都不会注入到模板文件中]</span>
    minify<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否压缩html</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="clean-webpack-plugin"><a href="#clean-webpack-plugin" class="header-anchor">#</a> clean-webpack-plugin</h3> <p>清除上一次打包遗留下来的打包文件。
<code>clean-webpack-plugin</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>const { CleanWebpackPlugin } = require('clean-webpack-plugin');

module.exports = {
	...
	plugins: [
   new CleanWebpackPlugin()
	]
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>mini-css-extract-plugin：Webpack4.0 中将 css 从 bundle 文件中提取成一个独立的 css 文件；在 3.0 版本使用 extract-text-webpack-plugin。</p> <p>terser-webpack-plugin：压缩 js 的插件，支持压缩 es6 代码，webpack4.0 默认使用的一个压缩插件，在 3.0 版本使用 uglifyjs-webpack-plugin 来压缩 js 代码。</p> <p>copy-webpack-plugin：将文件或者文件夹拷贝到构建的输出目录</p> <p>zip-webpack-plugin：将打包出的资源生成一个 zip 包</p> <p>optimize-css-assets-webpack-plugin：压缩 css 代码的插件</p> <p>webpack.DefinePlugin：创建一个在 编译 时可以配置的全局常量，比如设置 process.env.NODE_ENV，可以在 js 业务代码中使用。</p> <p>webpack.DllPlugin：抽取第三方 js，使用 dll 打包，笔者会在之后 Webpack 性能优化将到。</p> <h3 id="html-webpack-externals-plugin"><a href="#html-webpack-externals-plugin" class="header-anchor">#</a> html-webpack-externals-plugin</h3> <p>可以将一些公用包提取出来使用 cdn 引入，不打入 bundle 中：</p> <h2 id="常见配置项"><a href="#常见配置项" class="header-anchor">#</a> 常见配置项</h2> <h3 id="配置-tree-shaking"><a href="#配置-tree-shaking" class="header-anchor">#</a> 配置 tree-shaking</h3> <p>能够在模块的层面上做到打包后的代码只包含被引用并被执行的模块，而不被引用或不被执行的模块被删除掉，以起到减包的效果。
在生产环境下，webpack 自动开启了 tree-shaking 无需更多的配置。</p> <p>在对于 <code>import index.less</code> 或 <code>import '@babel/polly-fill'</code> 这种只有一个 import 而无 export 的代码，webpack 在进行 tree-shaking 时会自动忽略掉，而不进行打包，所以打包后的文件根本就没有 index.less 和 @babel/polly-fill 这个文件。
在 package.json 文件中</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;sideEffects&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 对所有的文件都启用 tree_shaking</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>而为了配置生效，我们需要将配置改为</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 在遇到碰到上面的几个模块，我们就不去进行 tree_shaking。</span>
<span class="token string">&quot;sideEffects&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token string">&quot;*.less&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;@babel/polly-fill&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="tree-shaking-的局限性"><a href="#tree-shaking-的局限性" class="header-anchor">#</a> tree-shaking 的局限性</h4> <ul><li>只能是静态声明和引用的 ES6 模块，不能是动态引入和声明的。</li></ul> <p>ES6 Module 是静态的，在代码编译阶段就能确定，模块之间的内部结构。
但是，类似这种代码在打包时会报错</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack编译时会报错</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span> module1 <span class="token keyword">from</span> <span class="token string">&quot;./module1&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span> module2 <span class="token keyword">from</span> <span class="token string">&quot;./module2&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>CommonJS 是动态的，模块的依赖关系建立在代码运行阶段。</p> <ul><li>只能处理模块级别，不能处理函数级别的冗余；</li> <li>只能处理 JS 相关冗余代码，不能处理 CSS 冗余代码。</li></ul> <h3 id="node-模块中的-path-join-与-path-resolve-之间的区别"><a href="#node-模块中的-path-join-与-path-resolve-之间的区别" class="header-anchor">#</a> node 模块中的 path.join 与 path.resolve 之间的区别</h3> <ul><li>path.join
path.join 只是将两个路径进行拼接。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;/a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 返回 'a/b'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>path.resolve
总是返回一个以相对于当前的工作目录的绝对路径。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// /Users/huhui/Desktop/未命名文件夹/webpack_demo/webpack-practice/dist</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="如何配置别名"><a href="#如何配置别名" class="header-anchor">#</a> 如何配置别名</h3> <p>在项目开发中，我们可以通过<code>alias</code>来配置别名，以此来缩短文件导入时文件路径的长度。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 配置extensions，当导入语句没有带文件后缀时，webpack会自动带上extensions里面的后缀去尝试访问文件是否存在，是一个数组</span>
<span class="token comment">// 配置了alias之后，以后所有js文件需要导入rem.js时只需 import 'rem'</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.json&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.vue&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      rem<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../src/common/js/rem.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string">&quot;reset.css&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../src/common/css/reset.css&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="webpack-dev-server-插件的作用"><a href="#webpack-dev-server-插件的作用" class="header-anchor">#</a> webpack-dev-server 插件的作用</h3> <p>使用 http 协议打开项目，项目启动的时候自动帮我们开启浏览器、指定端口起服务器等、自动帮我们刷新浏览器。</p> <p>配置跨域使用 proxy 选项。它的原理是使用 <strong>http-proxy-middleware</strong> 去把请求代理到一个外部的服务器。</p> <p>解决跨域原理：上面的参数列表中有一个 changeOrigin 参数, 是一个布尔值, 设置为 true, 本地就会虚拟一个服务器接收你的请求并代你发送该请求,</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;/proxy&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      target<span class="token operator">:</span> <span class="token string">&quot;http://your_api_server.com&quot;</span><span class="token punctuation">,</span>
      changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;^/proxy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="不同环境下使用不同的打包配置"><a href="#不同环境下使用不同的打包配置" class="header-anchor">#</a> 不同环境下使用不同的打包配置</h3> <p>因为有的时候我们 开发环境 和 生产环境 的打包所要做的事情是不同的。</p> <p>比如在 开发环境 中我们需要 <code>webpack-dev-server</code> 来帮我们进行快速的开发，同时需要 HMR 热更新帮我们进行页面的无刷新改动。而这些在我们的 生产环境 中都是不需要的。
讲一个具体的例子吧，不同的环境下，需要设置不同的<code>baseURL</code>。如何在打包的时候进行设置。
可以在<code>npm script</code> 脚本中配置 <code>process.env</code> 变量。
然后在 <code>webpack</code> 配置中 使用 <code>DefinePlugin</code> 这个<code>plugin</code> 将 <code>npm script</code> 中配置的变量 注入到全局中，以致于在 js 代码中可以直接获取到嗷。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function-variable function">chainWebpack</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">&quot;define&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;process.env&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token constant">HOST_URL</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>argv<span class="token punctuation">.</span><span class="token constant">HOST_URL</span> <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> args<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="对于-webpack-与浏览器缓存如何处理"><a href="#对于-webpack-与浏览器缓存如何处理" class="header-anchor">#</a> 对于 webpack 与浏览器缓存如何处理</h3> <p>当你重新打包了，如果没做任何的配置的话，打包出来的文件，文件名还是跟之前的一模一样。
那么当你刷新浏览器重新请求文件的时候，浏览器会直接从缓存中拿，而不是重新向服务器提交请求。
解决办法在 output 配置中，往输出的文件中配置 [contenthash] 占位符。 当内容改变了， [contenthash] 就会改变。对应的文件名也就改变了。</p> <h3 id="配置-hmr-热模块替换"><a href="#配置-hmr-热模块替换" class="header-anchor">#</a> 配置 HMR (热模块替换)</h3> <h3 id="打包-es6-代码-兼容性处理"><a href="#打包-es6-代码-兼容性处理" class="header-anchor">#</a> 打包 ES6 代码，(兼容性处理)</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 还需要安装 @babel/core</span>
      include<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>我们可以在项目根目录下 创建 .babelrc 文件来更好的管理 babel 的配置</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// .babelrc</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="如何配置一个多页面入口的应用"><a href="#如何配置一个多页面入口的应用" class="header-anchor">#</a> 如何配置一个多页面入口的应用？</h3> <p>什么样的场景下，适合多页面，当你的项目是多个不同的项目组成的，但是都是用的同一框架有很多相同的配置。那么就可以使用多页面配置。并且多页面打包后的文件是可以分别部署的。</p> <p>简单来讲，就是实现多个入口 和 多个 htmlwebpackPlugin 配置。每个入口对应一个 htmlwebpackPlugin 配置。</p> <p><a href="https://zhuanlan.zhihu.com/p/109527475" target="_blank" rel="noopener noreferrer">多页面配置<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="在项目中使用-webpack-做根据代码所处环境动态改变项目中的-baseurl"><a href="#在项目中使用-webpack-做根据代码所处环境动态改变项目中的-baseurl" class="header-anchor">#</a> 在项目中使用 webpack 做根据代码所处环境动态改变项目中的 baseURL</h3> <p>需求：可能一套代码会处于多个不同的环境，包含本地环境，测试环境，预发布环境，正式环境。每个环境，后端请求的 api 地址的前缀是不一样的。
那么我们就需要让代码在不同的环境中自动的动态配置 api 前缀。
如何实现？</p> <div class="language-script line-numbers-mode"><pre class="language-text"><code>npm i minimist -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>minimist 是个轻量级的 node.js 获取命令行参数的一个库，会将参数解析成一个字典。</p> <p>因为我们的 npm script 脚本命令一般是 <code>vue-cli-service serve --HOST_URL /api/</code></p> <p>那么通过 process.argv.slice(2) 就可以获取到我们需要的参数了</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> argv <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;minimist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>argv<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack配置，将获取到的参数写到webpack的环境变量中去</span>
<span class="token comment">// 这里的process.env就是Nodejs提供的一个API，它返回一个包含用户环境信息的对象。如果我们给Nodejs 设置一个环境变量，并把它挂载在 process.env 返回的对象上，便可以在代码中进行相应的环境判断。</span>
<span class="token function-variable function">chainWebpack</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">&quot;define&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;process.env&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token constant">HOST_URL</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>argv<span class="token punctuation">.</span><span class="token constant">HOST_URL</span> <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> args<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-npm script line-numbers-mode"><pre class="language-text"><code>    &quot;serve&quot;: &quot;vue-cli-service serve --HOST_URL /api/&quot;,
    &quot;Prebuild&quot;: &quot;vue-cli-service serve --HOST_URL /pre/api/&quot;,
    &quot;build&quot;: &quot;vue-cli-service serve --HOST_URL /current/&quot;,

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 在axios 配置 baseURL 时，直接使用 process.env 中的 变量值</span>
<span class="token keyword">const</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  baseURL<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">HOST_URL</span><span class="token punctuation">,</span> <span class="token comment">// url = base url + request url</span>
  timeout<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
  withCredentials<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><a href="https://www.jianshu.com/p/19d199f93045" target="_blank" rel="noopener noreferrer">参考链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.jianshu.com/p/231b931ab389" target="_blank" rel="noopener noreferrer">参考链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="在项目中使用到的-webpack-优化配置项"><a href="#在项目中使用到的-webpack-优化配置项" class="header-anchor">#</a> 在项目中使用到的 webpack 优化配置项</h2> <ul><li>优化打包速度</li> <li>优化打包文件的体积</li> <li>开启 Nginx 文件对前端资源文件的 gzip 压缩</li> <li>优化首屏加载速度</li></ul> <h3 id="优化打包速度"><a href="#优化打包速度" class="header-anchor">#</a> 优化打包速度</h3> <h4 id="合理的配置-mode-参数与-devtool-参数"><a href="#合理的配置-mode-参数与-devtool-参数" class="header-anchor">#</a> 合理的配置 mode 参数与 devtool 参数</h4> <p>mode 可设置<code>development</code>和 <code>production</code>两个参数
如果没有设置，<strong>webpack4</strong> 会将 <code>mode</code> 的默认值设置为 <code>production</code> <code>production</code>模式下会进行<code>tree shaking</code>(去除无用代码)和<code>uglifyjs</code>(代码压缩混淆)</p> <h4 id="缩小文件的搜索范围-配置-include-exclude-alias-noparse-extensions"><a href="#缩小文件的搜索范围-配置-include-exclude-alias-noparse-extensions" class="header-anchor">#</a> 缩小文件的搜索范围(配置 include exclude alias noParse extensions)</h4> <p><code>alias</code>: 当我们代码中出现 <code>import 'vue'</code>时， webpack 会采用向上递归搜索的方式去 node_modules 目录下找。为了减少搜索范围我们可以直接告诉 webpack 去哪个路径下查找。也就是别名(alias)的配置。
<code>include</code>:<code>exclude</code> 同样配置<code>include</code> <code>exclude</code>也可以减少<code>webpack loader</code>的搜索转换时间。
<code>noParse</code>:当我们代码中使用到<code>import jq from 'jquery'</code>时，<code>webpack</code>会去解析<code>jq</code>这个库是否有依赖其他的包。但是我们对类似 jquery 这类依赖库，一般会认为不会引用其他的包(特殊除外,自行判断)。增加 noParse 属性,告诉 webpack 不必解析，以此增加打包速度。
<code>extensions</code>:<code>webpack</code>会根据<code>extensions</code>定义的后缀查找文件(频率较高的文件类型优先写在前面)
<img src="https://user-gold-cdn.xitu.io/2019/12/13/16efe4728f877d46?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="webpack优化"></p> <h4 id="抽离第三方模块"><a href="#抽离第三方模块" class="header-anchor">#</a> 抽离第三方模块</h4> <blockquote><p>对于开发项目中不经常会变更的静态依赖文件。类似于我们的 elementUi、vue 全家桶等等。因为很少会变更，所以我们不希望这些依赖要被集成到每一次的构建逻辑中去。 这样做的好处是每次更改我本地代码的文件的时候，webpack 只需要打包我项目本身的文件代码，而不会再去编译第三方库。以后只要我们不升级第三方包的时候，那么 webpack 就不会对这些库去打包，这样可以快速的提高打包的速度。</p></blockquote> <p><a href="https://juejin.im/post/6844904031240863758##heading-28" target="_blank" rel="noopener noreferrer">参考文献<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="优化打包的体积"><a href="#优化打包的体积" class="header-anchor">#</a> 优化打包的体积</h3> <h4 id="引入-webpack-bundle-analyzer-分析打包后的文件"><a href="#引入-webpack-bundle-analyzer-分析打包后的文件" class="header-anchor">#</a> 引入 webpack-bundle-analyzer 分析打包后的文件</h4> <p>引入 webpack-bundle-analyzer 分析打包后的文件，看看是哪一部分占据的大部分空间，具体的进行打包体积的优化。</p> <h4 id="externals"><a href="#externals" class="header-anchor">#</a> externals</h4> <blockquote><p>好处在于，在项目可以正常依靠<code>import</code>来使用，而又可以再最终打包的文件将其剔除出来，而在打包后的 index.html 文件中使用 CDN 的方式去引用它，从而减少打包的体积。</p></blockquote> <p>比如说像<code>vue</code>, <code>vuex</code>等第三方库，本身不会经常改变，而在项目又是经常需要使用的第三方依赖库。就可以使用 externals</p> <h4 id="取消-map-文件的加载"><a href="#取消-map-文件的加载" class="header-anchor">#</a> 取消.map 文件的加载</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//在webpack配置中</span>
 productionSourceMap<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这个仅仅是在开发时，生成 sourceMap 源文件，方便代码调试的，在正式打包的时候，可以将其关闭，减少打包后的体积。</p> <h3 id="优化首屏加载速度"><a href="#优化首屏加载速度" class="header-anchor">#</a> 优化首屏加载速度</h3> <h4 id="路由懒加载"><a href="#路由懒加载" class="header-anchor">#</a> 路由懒加载</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'../views/Home.vue'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="图片懒加载"><a href="#图片懒加载" class="header-anchor">#</a> 图片懒加载</h4> <p>自己如何实现一个图片懒加载？</p> <p>懒加载原理</p> <p>图片的标签是 <code>img</code>标签，图片的来源主要是 src 属性，浏览器是否发起加载图片的请求是根据是否有 src 属性决定的。<a href="http://caibaojian.com/vue-image-lazyload.html" target="_blank" rel="noopener noreferrer">·<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>所以可以从 <code>img</code>标签的 src 属性入手，在没进到可视区域的时候，就先不给 img 标签的 src 属性赋值，或者使用本地的图片 url 地址代替，作为默认显示的一种图片。</p> <p><a href="http://caibaojian.com/vue-image-lazyload.html" target="_blank" rel="noopener noreferrer">实现懒加载<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="使用-nginx-开启-gzip-文件压缩"><a href="#使用-nginx-开启-gzip-文件压缩" class="header-anchor">#</a> 使用 Nginx 开启 gzip 文件压缩</h4> <p>如果你的静态资源服务器使用的是 nginx ,在 nginx.conf 配置文件中。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>   gzip on<span class="token punctuation">;</span>
	 gzip_min_length <span class="token number">1</span>k<span class="token punctuation">;</span>
	 gzip_comp_level <span class="token number">5</span><span class="token punctuation">;</span>
	 gzip_buffers <span class="token number">4</span> <span class="token number">16</span>k<span class="token punctuation">;</span>
	 gzip_types text<span class="token operator">/</span>plain text<span class="token operator">/</span>css application<span class="token operator">/</span>json application<span class="token operator">/</span>javascript application<span class="token operator">/</span>x<span class="token operator">-</span>javascript text<span class="token operator">/</span>xml application<span class="token operator">/</span>xml application<span class="token operator">/</span>x
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="你在项目中是如何做-webpack-优化的"><a href="#你在项目中是如何做-webpack-优化的" class="header-anchor">#</a> 你在项目中是如何做 webpack 优化的?</h2> <p>首先讲下为何要优化？减少本地开发时启动的时间，减少打包的时间，减少打包过后的体积从而提高页面的访问速度。</p> <h3 id="代码分片"><a href="#代码分片" class="header-anchor">#</a> 代码分片</h3> <p>可以有效降低首屏加载资源的大小</p> <h5 id="通过入口划分代码"><a href="#通过入口划分代码" class="header-anchor">#</a> 通过入口划分代码</h5> <p>直接把不常变动的库的代码 写在 entry 入口处</p> <h5 id="使用-optimization-splitchunks"><a href="#使用-optimization-splitchunks" class="header-anchor">#</a> 使用 optimization.SplitChunks</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code>optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
  splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>
    chunks<span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="什么是按需加载-资源异步加载"><a href="#什么是按需加载-资源异步加载" class="header-anchor">#</a> 什么是按需加载(资源异步加载)？</h3> <p>当模块数量过多，资源体积过大，可以把一些暂时不用的资源进行延迟加载。这样做的效果是，在页面初次渲染的时候用户下载的资源是很小的，后续的模块等到恰当的时机再去触发加载。</p> <p>在 webpack 中 我们可以使用 <code>import()</code>进行异步加载。</p> <p><strong>注意 webpack 中的 import 与 ES6 module 中的 import 是不同的</strong></p> <p>在<code>webpack</code>中通过<code>import()</code> 函数加载的模块及其依赖会被异步地进行加载，并返回一个异步对象。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// foo.js</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./bar.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> add <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// bar.js</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="生产环境下-webpack-的配置"><a href="#生产环境下-webpack-的配置" class="header-anchor">#</a> 生产环境下 <code>webpack</code> 的配置</h3> <ul><li><p>如何让用户更快的加载资源</p></li> <li><p>如何压缩资源</p></li> <li><p>如何添加环境变量优化打包</p></li> <li><p>如何最大限度使用缓存</p></li> <li><p>环境变量的使用(DefinePlugin)</p></li> <li><p>source map 的机制与策略 (devtool)</p></li> <li><p>资源压缩 (mode: 'production')</p></li> <li><p>优化 hash 与 缓存 (chunkhash)</p></li> <li><p>动态 html (html-webpack-plugin)</p></li></ul> <h5 id="环境变量的使用"><a href="#环境变量的使用" class="header-anchor">#</a> 环境变量的使用</h5> <p>npm script 脚本的使用</p> <ul><li>可以在脚本中输入变量, 在 webpack 中，进行使用</li> <li>可以为 webpack 配置不同的打包配置文件 使用 --config</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 在 npm script 配置变量</span>

<span class="token string">&quot;script&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot; ENV=development webpack-dev-server&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ENV=production webpack&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment">// webpack.config.js</span>
cost <span class="token constant">ENV</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">ENV</span>
<span class="token keyword">const</span> isProd <span class="token operator">=</span> <span class="token constant">ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        filename<span class="token operator">:</span> isProd <span class="token operator">?</span> <span class="token string">'budle@[chunkhash].js'</span><span class="token operator">:</span> <span class="token string">'bundle.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mode<span class="token operator">:</span> <span class="token constant">ENV</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 配置不同的配置文件进行打包，</span>
<span class="token string">&quot;script&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server --config=webpack.development.config.js&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --config=webpack.production.config.js&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 新建一个 webpack.common.js 存储公共的webpack配置， 然后再使用 webpack-merge 插件 进行配置合并。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>环境变量的设置
我们可以通过 <code>DefinePlugin</code> 插件来进行环境变量的设置，然后在 js 代码中使用。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token constant">ENV</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token string">&quot;production&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// app.js</span>
document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token constant">ENV</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>讲讲什么是 <code>process.env</code>
process.env 是 Node.js 存放当前进程环境变量的对象，而 NODE_ENV 则可以让开发者指定当前的运行环境。</p> <p>当我们在 webpack 中指定了 mode: 'production', 那么 process.env.NODE_ENV 的值默认就是 production , 不需要人为去配置了。</p> <p>讲讲什么是 <code>source map</code>
source map 是指将编译，打包，压缩后的代码映射回源代码的过程。
它的工作原理: 在 <code>devtool</code>选项中开启 source map 之后，在每个对应的打包后的 budle 文件同目录下，都会有一个 以文件名.map 文件， map 文件存储的转换前的源码位置。通过.map 文件，我们就能找到对应的源码位置，从而进行调试。
再来看看 对应的 <code>devtool</code>选项的其他几个备选项。</p> <ul><li>cheap-source-map</li> <li>eval-source-map</li> <li>none</li></ul> <p>推荐使用 <code>cheap-source-map</code>, 因为生成完整的 source map 也是一个比较耗费时间和资源的事情，<code>cheap-source-map</code>是一个较为折中的方案。</p> <h5 id="压缩代码"><a href="#压缩代码" class="header-anchor">#</a> 压缩代码</h5> <h6 id="压缩-js"><a href="#压缩-js" class="header-anchor">#</a> 压缩 js</h6> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 注意： 如果已经开启了 mode: production,无需配置，默认开启。</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">&quot;./app.js&quot;</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> isProd <span class="token operator">?</span> <span class="token string">&quot;budle@[chunkhash].js&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;bundle.js&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    minimize<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h6 id="压缩-css"><a href="#压缩-css" class="header-anchor">#</a> 压缩 css</h6> <p>前提是使用 <code>extract-text-webpack-plugin</code>或者<code>mini-css-extract-plugin</code>将样式提取出来，接着使用<code>optimize-webpack-plugin</code>来进行压缩。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> ExtractTextPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'extract-text-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> OptimizeCSSAssetsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'optimize-css-assets-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> ExtractTextPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                fallback<span class="token operator">:</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
                use<span class="token operator">:</span> <span class="token string">'css-loader'</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">OptimizeCSSAssetsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// 生效范围，只压缩到匹配的资源</span>
    assetNameRegExp<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.optimize\.css$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span>
    <span class="token comment">// 压缩处理器，默认为 cssnano</span>
    cssProcessor<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cssnano'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 压缩处理器的配置</span>
    cssProcessorOptions<span class="token operator">:</span> <span class="token punctuation">{</span> discardComments<span class="token operator">:</span> <span class="token punctuation">{</span> removeAll<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    canPrint<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h5 id="dll-plugin"><a href="#dll-plugin" class="header-anchor">#</a> DLL plugin</h5> <p>就是事先把常用但又构建时间长的代码提前打包好（例如 react、react-dom），取个名字叫 dll。后面再打包的时候就跳过原来的未打包代码，直接用 dll。这样一来，构建时间就会缩短，提高 webpack 打包速度。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">lastUpdate:</span> <span class="time">1/3/2021, 12:19:17 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vue-press-docs/pages/project/specification.html" class="prev">
        项目配置
      </a></span> <span class="next"><a href="/vue-press-docs/pages/project/microApp.html">
        落地实践
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vue-press-docs/assets/js/app.d8725ef0.js" defer></script><script src="/vue-press-docs/assets/js/2.a05206b7.js" defer></script><script src="/vue-press-docs/assets/js/72.759f4574.js" defer></script>
  </body>
</html>
